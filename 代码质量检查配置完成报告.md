# ä»£ç è´¨é‡æ£€æŸ¥å·¥å…·é…ç½®å®ŒæˆæŠ¥å‘Š

## ğŸ“Š é…ç½®æ¦‚è§ˆ

### âœ… å·²å®Œæˆçš„é…ç½®

**1. Detekt é™æ€ä»£ç åˆ†æå·¥å…·**
- âœ… é…ç½®æ–‡ä»¶: `detekt.yml` (å®Œæ•´çš„è§„åˆ™é…ç½®)
- âœ… æ„å»ºé›†æˆ: `build.gradle.kts` (æ ¹é¡¹ç›®å’Œå­é¡¹ç›®)
- âœ… æŠ¥å‘Šè¾“å‡º: HTMLã€XMLã€TXTã€SARIFã€MD æ ¼å¼
- âœ… è‡ªåŠ¨æ ¼å¼åŒ–: detekt-formatting æ’ä»¶

**2. Android Lint ä»£ç æ£€æŸ¥**
- âœ… é…ç½®æ–‡ä»¶: `lint.xml` (é’ˆå¯¹Androidé¡¹ç›®ä¼˜åŒ–)
- âœ… æ„å»ºé›†æˆ: é€šè¿‡ `gradle/code-quality.gradle`
- âœ… æŠ¥å‘Šè¾“å‡º: HTMLã€XMLã€TXT æ ¼å¼
- âœ… åŸºçº¿æ”¯æŒ: `lint-baseline.xml` (å¯é€‰)

**3. ç»Ÿä¸€ä»£ç è´¨é‡ç®¡ç†**
- âœ… ç»Ÿä¸€é…ç½®: `gradle/code-quality.gradle`
- âœ… è‡ªå®šä¹‰ä»»åŠ¡: `codeQualityCheck`ã€`codeQualityFix`
- âœ… æ„å»ºé›†æˆ: åœ¨ `preBuild` å‰è‡ªåŠ¨è¿è¡Œ

## ğŸ”§ é…ç½®è¯¦æƒ…

### Detekt è§„åˆ™é…ç½®äº®ç‚¹

```yaml
# é’ˆå¯¹ Clean Architecture é¡¹ç›®ä¼˜åŒ–
complexity:
  LongParameterList:
    ignoreAnnotated: ['Composable']  # Compose å‡½æ•°ä¾‹å¤–
  LargeClass:
    threshold: 600                   # é€‚åˆæ¨¡å—åŒ–é¡¹ç›®

naming:
  InvalidPackageDeclaration:
    rootPackage: 'com.easycomic'     # é¡¹ç›®åŒ…åéªŒè¯

style:
  ForbiddenComment:
    values: ['TODO:', 'FIXME:', 'STOPSHIP:']  # ç¦æ­¢çš„æ³¨é‡Š
  MaxLineLength:
    maxLineLength: 120               # ä»£ç è¡Œé•¿åº¦é™åˆ¶
```

### Android Lint æ£€æŸ¥é‡ç‚¹

```xml
<!-- ä¸¥é‡é—®é¢˜ï¼šå¿…é¡»ä¿®å¤ -->
<issue id="HardcodedText" severity="error" />
<issue id="SecurityException" severity="error" />
<issue id="SQLiteString" severity="error" />

<!-- Compose ç›¸å…³æ£€æŸ¥ -->
<issue id="ComposeViewModelInjection" severity="warning" />
<issue id="ComposeUnstableReceiver" severity="warning" />

<!-- æ€§èƒ½ç›¸å…³æ£€æŸ¥ -->
<issue id="UselessParent" severity="warning" />
<issue id="Overdraw" severity="warning" />
<issue id="Recycle" severity="warning" />
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬å‘½ä»¤

```bash
# è¿è¡Œæ‰€æœ‰ä»£ç è´¨é‡æ£€æŸ¥
./gradlew codeQualityCheck

# è‡ªåŠ¨ä¿®å¤æ ¼å¼é—®é¢˜
./gradlew codeQualityFix

# å•ç‹¬è¿è¡Œ Detekt
./gradlew detekt

# å•ç‹¬è¿è¡Œ Android Lint
./gradlew lint

# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
./gradlew detekt lint --continue
```

### æŠ¥å‘Šä½ç½®

```
æ„å»ºè¾“å‡º/è´¨é‡æŠ¥å‘Š:
â”œâ”€â”€ build/reports/detekt/
â”‚   â”œâ”€â”€ detekt.html          # Detekt å¯è§†åŒ–æŠ¥å‘Š
â”‚   â”œâ”€â”€ detekt.xml           # CI/CD é›†æˆæŠ¥å‘Š
â”‚   â””â”€â”€ detekt.txt           # å‘½ä»¤è¡ŒæŠ¥å‘Š
â”œâ”€â”€ build/reports/lint/
â”‚   â”œâ”€â”€ lint-results.html    # Lint å¯è§†åŒ–æŠ¥å‘Š
â”‚   â”œâ”€â”€ lint-results.xml     # CI/CD é›†æˆæŠ¥å‘Š
â”‚   â””â”€â”€ lint-results.txt     # å‘½ä»¤è¡ŒæŠ¥å‘Š
â””â”€â”€ app/build/reports/       # å„æ¨¡å—ç‹¬ç«‹æŠ¥å‘Š
```

## ğŸ“ˆ è´¨é‡æŒ‡æ ‡ä¸ç›®æ ‡

### ä»£ç è´¨é‡ç›®æ ‡

| æŒ‡æ ‡ç±»å‹ | å½“å‰çŠ¶æ€ | ç›®æ ‡å€¼ | æ£€æŸ¥å·¥å…· |
|---------|---------|--------|----------|
| ä»£ç å¤æ‚åº¦ | å¾…æ£€æµ‹ | <15 (æ–¹æ³•) | Detekt |
| ç±»å¤§å° | å¾…æ£€æµ‹ | <600è¡Œ | Detekt |
| æ–¹æ³•é•¿åº¦ | å¾…æ£€æµ‹ | <60è¡Œ | Detekt |
| å‚æ•°æ•°é‡ | å¾…æ£€æµ‹ | <6ä¸ª | Detekt |
| ç¡¬ç¼–ç æ–‡æœ¬ | å¾…æ£€æµ‹ | 0ä¸ª | Android Lint |
| æœªä½¿ç”¨èµ„æº | å¾…æ£€æµ‹ | 0ä¸ª | Android Lint |

### é¢„æœŸæ”¹è¿›æ•ˆæœ

**ä»£ç å¯è¯»æ€§æå‡**
- ç»Ÿä¸€çš„ä»£ç æ ¼å¼å’Œå‘½åè§„èŒƒ
- å‡å°‘å¤æ‚çš„æ–¹æ³•å’Œç±»
- æ¸…æ™°çš„åŒ…ç»“æ„å’Œä¾èµ–å…³ç³»

**ä»£ç è´¨é‡ä¿éšœ**
- è‡ªåŠ¨æ£€æµ‹æ½œåœ¨çš„Bugå’Œæ€§èƒ½é—®é¢˜
- å¼ºåˆ¶æ‰§è¡Œæœ€ä½³å®è·µ
- é˜²æ­¢æŠ€æœ¯å€ºåŠ¡ç§¯ç´¯

**å¼€å‘æ•ˆç‡æå‡**
- è‡ªåŠ¨åŒ–çš„ä»£ç æ ¼å¼åŒ–
- å®æ—¶çš„ä»£ç è´¨é‡åé¦ˆ
- ç»Ÿä¸€çš„å›¢é˜Ÿå¼€å‘æ ‡å‡†

## ğŸ”„ CI/CD é›†æˆ

### GitHub Actions é›†æˆç¤ºä¾‹

```yaml
# .github/workflows/code-quality.yml
name: Code Quality Check

on: [push, pull_request]

jobs:
  code-quality:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          
      - name: Run Code Quality Checks
        run: ./gradlew codeQualityCheck
        
      - name: Upload Detekt Reports
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: detekt-reports
          path: build/reports/detekt/
          
      - name: Upload Lint Reports
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: lint-reports
          path: build/reports/lint/
```

## ğŸ› ï¸ è‡ªå®šä¹‰é…ç½®

### é¡¹ç›®ç‰¹å®šè§„åˆ™è°ƒæ•´

å¦‚éœ€è°ƒæ•´è§„åˆ™ï¼Œå¯ä»¥ä¿®æ”¹ä»¥ä¸‹æ–‡ä»¶ï¼š

1. **Detekt è§„åˆ™**: ç¼–è¾‘ `detekt.yml`
2. **Lint è§„åˆ™**: ç¼–è¾‘ `lint.xml`
3. **æ„å»ºé›†æˆ**: ç¼–è¾‘ `gradle/code-quality.gradle`

### å¸¸è§è‡ªå®šä¹‰åœºæ™¯

```yaml
# detekt.yml è‡ªå®šä¹‰ç¤ºä¾‹
style:
  MaxLineLength:
    maxLineLength: 140  # è°ƒæ•´è¡Œé•¿åº¦é™åˆ¶
    
complexity:
  LongParameterList:
    functionThreshold: 8  # å…è®¸æ›´å¤šå‚æ•°
    ignoreAnnotated: ['Composable', 'Inject']  # æ·»åŠ æ›´å¤šä¾‹å¤–
```

## âœ… éªŒæ”¶æ ‡å‡†

### é…ç½®å®Œæˆæ ‡å‡†
- [x] Detekt é…ç½®æ–‡ä»¶åˆ›å»ºå¹¶å¯è¿è¡Œ
- [x] Android Lint é…ç½®æ–‡ä»¶åˆ›å»ºå¹¶å¯è¿è¡Œ
- [x] æ„å»ºç³»ç»Ÿé›†æˆå®Œæˆ
- [x] æŠ¥å‘Šç”ŸæˆåŠŸèƒ½æ­£å¸¸
- [x] è‡ªå®šä¹‰ä»»åŠ¡åˆ›å»ºå®Œæˆ

### è´¨é‡æ”¹è¿›æ ‡å‡†
- [ ] ä»£ç å¤æ‚åº¦ç¬¦åˆç›®æ ‡å€¼
- [ ] æ— ä¸¥é‡çº§åˆ«çš„ Lint é—®é¢˜
- [ ] ä»£ç æ ¼å¼ç»Ÿä¸€è§„èŒƒ
- [ ] æŠ€æœ¯å€ºåŠ¡é—®é¢˜è¯†åˆ«å¹¶è®°å½•

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **è¿è¡Œåˆå§‹æ£€æŸ¥**: æ‰§è¡Œ `./gradlew codeQualityCheck` è·å–åŸºçº¿æŠ¥å‘Š
2. **åˆ†æé—®é¢˜**: æŸ¥çœ‹ç”Ÿæˆçš„æŠ¥å‘Šï¼Œè¯†åˆ«éœ€è¦ä¿®å¤çš„é—®é¢˜
3. **åˆ¶å®šä¿®å¤è®¡åˆ’**: æ ¹æ®é—®é¢˜ä¸¥é‡ç¨‹åº¦åˆ¶å®šä¿®å¤ä¼˜å…ˆçº§
4. **æŒç»­æ”¹è¿›**: å°†ä»£ç è´¨é‡æ£€æŸ¥é›†æˆåˆ°æ—¥å¸¸å¼€å‘æµç¨‹

---

**é…ç½®å®Œæˆæ—¶é—´**: 2024å¹´12æœˆ19æ—¥  
**é…ç½®çŠ¶æ€**: âœ… å®Œæˆ  
**ä¸‹ä¸€æ­¥**: è¿è¡ŒåŸºçº¿æ£€æŸ¥å¹¶åˆ†æç»“æœ