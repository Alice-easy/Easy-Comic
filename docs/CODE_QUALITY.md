# ä»£ç è´¨é‡æ£€æŸ¥å·¥å…·æŒ‡å—

Easy Comic é¡¹ç›®é›†æˆäº†å®Œæ•´çš„ä»£ç è´¨é‡æ£€æŸ¥å·¥å…·é“¾ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€å®‰å…¨æ€§å’Œä¸€è‡´æ€§ã€‚

## ğŸ› ï¸ é›†æˆçš„å·¥å…·

### 1. Detekt - é™æ€ä»£ç åˆ†æ

**ç”¨é€”**: Kotlin é™æ€ä»£ç åˆ†æï¼Œæ£€æµ‹ä»£ç å¼‚å‘³ã€å¤æ‚åº¦ã€æ½œåœ¨é”™è¯¯ç­‰

**è¿è¡Œå‘½ä»¤**:

```bash
# è¿è¡ŒDetektåˆ†æ
./gradlew detekt

# æŸ¥çœ‹æŠ¥å‘Š
open app/build/reports/detekt/detekt.html
```

**é…ç½®æ–‡ä»¶**: `detekt.yml`

- è‡ªå®šä¹‰è§„åˆ™é…ç½®
- å¤æ‚åº¦é˜ˆå€¼è®¾ç½®
- ä»£ç é£æ ¼æ£€æŸ¥
- æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 2. ktlint - ä»£ç æ ¼å¼åŒ–

**ç”¨é€”**: Kotlin ä»£ç æ ¼å¼æ ‡å‡†åŒ–ï¼Œç¡®ä¿ä»£ç é£æ ¼ä¸€è‡´æ€§

**è¿è¡Œå‘½ä»¤**:

```bash
# æ£€æŸ¥ä»£ç æ ¼å¼
./gradlew ktlintCheck

# è‡ªåŠ¨ä¿®å¤æ ¼å¼é—®é¢˜
./gradlew ktlintFormat

# æˆ–è€…ä½¿ç”¨è‡ªå®šä¹‰ä»»åŠ¡
./gradlew formatCode
```

**é…ç½®æ–‡ä»¶**: `.editorconfig`

- ç¼©è¿›å’Œæ¢è¡Œè§„åˆ™
- æœ€å¤§è¡Œé•¿åº¦: 120 å­—ç¬¦
- Android é¡¹ç›®ç‰¹å®šè®¾ç½®
- Compose å‡½æ•°å‘½åè§„åˆ™

### 3. OWASP ä¾èµ–å®‰å…¨æ‰«æ

**ç”¨é€”**: æ£€æµ‹ç¬¬ä¸‰æ–¹ä¾èµ–çš„å·²çŸ¥å®‰å…¨æ¼æ´

**è¿è¡Œå‘½ä»¤**:

```bash
# è¿è¡Œä¾èµ–å®‰å…¨æ‰«æ
./gradlew dependencyCheckAnalyze

# æŸ¥çœ‹æŠ¥å‘Š
open build/reports/dependency-check-report.html
```

**é…ç½®æ–‡ä»¶**: `config/dependency-check-suppressions.xml`

- è¯¯æŠ¥æŠ‘åˆ¶é…ç½®
- å·²çŸ¥å®‰å…¨é—®é¢˜çš„ä¾‹å¤–å¤„ç†
- CVE ç™½åå•ç®¡ç†

### 4. Gradle ä¾èµ–æ›´æ–°æ£€æŸ¥

**ç”¨é€”**: æ£€æŸ¥è¿‡æœŸçš„ä¾èµ–ç‰ˆæœ¬

**è¿è¡Œå‘½ä»¤**:

```bash
# æ£€æŸ¥ä¾èµ–æ›´æ–°
./gradlew dependencyUpdates

# æŸ¥çœ‹æŠ¥å‘Š
open build/reports/dependencyUpdates/report.html
```

### 5. SonarQube (å¯é€‰)

**ç”¨é€”**: ç»¼åˆä»£ç è´¨é‡åˆ†æå¹³å°

**é…ç½®**: åœ¨æ ¹ç›®å½• `build.gradle.kts` ä¸­å·²é¢„é…ç½®ï¼Œéœ€è¦ SonarQube æœåŠ¡å™¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œæ‰€æœ‰ä»£ç è´¨é‡æ£€æŸ¥

```bash
# è¿è¡Œå®Œæ•´çš„ä»£ç è´¨é‡æ£€æŸ¥å¥—ä»¶
./gradlew codeQualityCheck
```

è¿™ä¸ªå‘½ä»¤ä¼šä¾æ¬¡æ‰§è¡Œï¼š

- âœ… Detekt é™æ€åˆ†æ
- âœ… ktlint ä»£ç æ ¼å¼æ£€æŸ¥
- âœ… ä¾èµ–å®‰å…¨æ‰«æ
- âœ… Jacoco æµ‹è¯•è¦†ç›–ç‡
- âœ… Android Lint æ£€æŸ¥

### ä¿®å¤ä»£ç æ ¼å¼é—®é¢˜

```bash
# è‡ªåŠ¨ä¿®å¤ä»£ç æ ¼å¼
./gradlew formatCode
```

### æäº¤å‰æ£€æŸ¥

```bash
# æ¨¡æ‹Ÿpre-commitæ£€æŸ¥
./gradlew preCommitCheck
```

## ğŸ“‹ Pre-commit Hooks

é¡¹ç›®æ”¯æŒ [pre-commit](https://pre-commit.com/) é’©å­ï¼Œåœ¨æäº¤å‰è‡ªåŠ¨è¿è¡Œè´¨é‡æ£€æŸ¥ã€‚

### å®‰è£… pre-commit

```bash
# å®‰è£…pre-commitå·¥å…·
pip install pre-commit

# å®‰è£…é¡¹ç›®é’©å­
pre-commit install

# æ‰‹åŠ¨è¿è¡Œæ‰€æœ‰é’©å­
pre-commit run --all-files
```

### é’©å­é…ç½®

é…ç½®æ–‡ä»¶: `.pre-commit-config.yaml`

**æäº¤æ—¶æ£€æŸ¥**:

- ktlint ä»£ç æ ¼å¼
- Detekt é™æ€åˆ†æ
- Android Lint
- TODO/FIXME æ³¨é‡Šæ£€æŸ¥
- è°ƒè¯•ä»£ç æ£€æŸ¥
- ç¡¬ç¼–ç å­—ç¬¦ä¸²æ£€æŸ¥

**æ¨é€æ—¶æ£€æŸ¥**:

- å•å…ƒæµ‹è¯•
- ä¾èµ–å®‰å…¨æ‰«æ

## ğŸ“Š è´¨é‡æŒ‡æ ‡

### ä»£ç è¦†ç›–ç‡ç›®æ ‡

- **å•å…ƒæµ‹è¯•è¦†ç›–ç‡**: â‰¥ 90%
- **åˆ†æ”¯è¦†ç›–ç‡**: â‰¥ 85%
- **è¡Œè¦†ç›–ç‡**: â‰¥ 90%

### ä»£ç è´¨é‡æ ‡å‡†

- **Detekt é—®é¢˜**: 0 ä¸ªä¸¥é‡é—®é¢˜
- **ktlint è¿è§„**: 0 ä¸ªæ ¼å¼é—®é¢˜
- **Android Lint**: 0 ä¸ªé”™è¯¯ï¼Œâ‰¤ 5 ä¸ªè­¦å‘Š
- **å®‰å…¨æ¼æ´**: 0 ä¸ªé«˜å±å’Œä¸¥é‡æ¼æ´

### å¤æ‚åº¦é™åˆ¶

- **å‡½æ•°å¤æ‚åº¦**: â‰¤ 15
- **ç±»å¤æ‚åº¦**: â‰¤ 600
- **æ–¹æ³•è¡Œæ•°**: â‰¤ 60
- **å‚æ•°ä¸ªæ•°**: â‰¤ 6

## ğŸ”§ IDE é›†æˆ

### Android Studio è®¾ç½®

1. **ktlint æ’ä»¶**:

   - å®‰è£… "ktlint" æ’ä»¶
   - é…ç½®è‡ªåŠ¨æ ¼å¼åŒ–å¿«æ·é”®

2. **Detekt æ’ä»¶**:

   - å®‰è£… "Detekt" æ’ä»¶
   - é…ç½®å®æ—¶æ£€æŸ¥

3. **ä»£ç é£æ ¼**:
   - å¯¼å…¥é¡¹ç›®çš„ `.editorconfig` è®¾ç½®
   - è®¾ç½®è¡Œé•¿åº¦ä¸º 120 å­—ç¬¦

### VS Code è®¾ç½®

```json
{
  "kotlin.languageServer.enabled": true,
  "editor.rulers": [120],
  "editor.formatOnSave": true
}
```

## ğŸ“ˆ ä»£ç è´¨é‡ç›‘æ§

ä»£ç è´¨é‡æ£€æŸ¥å·²é›†æˆåˆ°æœ¬åœ°å¼€å‘æµç¨‹ä¸­ï¼š

### è‡ªåŠ¨è¿è¡Œæ—¶æœº

- **æœ¬åœ°å¼€å‘**: æ‰‹åŠ¨è¿è¡Œä»£ç è´¨é‡æ£€æŸ¥
- **æäº¤å‰**: æ‰‹åŠ¨æ£€æŸ¥ ktlintã€Detektã€Lint
- **å‘å¸ƒåˆ†æ”¯**: åŒ…å«ä¾èµ–å®‰å…¨æ‰«æ

### å¤±è´¥ç­–ç•¥

- **ktlint è¿è§„**: æ„å»ºå¤±è´¥ âŒ
- **Detekt ä¸¥é‡é—®é¢˜**: æ„å»ºå¤±è´¥ âŒ
- **å•å…ƒæµ‹è¯•å¤±è´¥**: æ„å»ºå¤±è´¥ âŒ
- **ä¾èµ–å®‰å…¨æ¼æ´**: è­¦å‘Šä½†ç»§ç»­ âš ï¸

## ğŸ” æŠ¥å‘Šå’Œåˆ†æ

### æŸ¥çœ‹æ£€æŸ¥æŠ¥å‘Š

```bash
# ç”Ÿæˆæ‰€æœ‰è´¨é‡æŠ¥å‘Š
./gradlew codeQualityCheck

# æŠ¥å‘Šä½ç½®
echo "ğŸ“Š è´¨é‡æ£€æŸ¥æŠ¥å‘Š:"
echo "  - Detekt: app/build/reports/detekt/detekt.html"
echo "  - æµ‹è¯•è¦†ç›–ç‡: app/build/reports/jacoco/jacocoTestReport/html/index.html"
echo "  - Android Lint: app/build/reports/lint-results.html"
echo "  - ä¾èµ–å®‰å…¨: build/reports/dependency-check-report.html"
```

## ğŸ›¡ï¸ å®‰å…¨æœ€ä½³å®è·µ

### ä¾èµ–ç®¡ç†

- å®šæœŸæ›´æ–°ä¾èµ–ç‰ˆæœ¬
- å…³æ³¨å®‰å…¨å…¬å‘Š
- ä½¿ç”¨å®˜æ–¹ç»´æŠ¤çš„åº“
- é¿å…ä½¿ç”¨åºŸå¼ƒçš„ä¾èµ–

### ä»£ç å®‰å…¨

- é¿å…ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
- ä½¿ç”¨å®‰å…¨çš„åŠ å¯†æ–¹æ³•
- è¾“å…¥éªŒè¯å’Œè¾¹ç•Œæ£€æŸ¥
- æƒé™æœ€å°åŒ–åŸåˆ™

## â“ å¸¸è§é—®é¢˜

### Q: ktlint æ£€æŸ¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

A: è¿è¡Œ `./gradlew ktlintFormat` è‡ªåŠ¨ä¿®å¤å¤§éƒ¨åˆ†æ ¼å¼é—®é¢˜

### Q: Detekt æŠ¥å‘Šå¤ªå¤šé—®é¢˜ï¼Ÿ

A: å¯ä»¥åœ¨ `detekt.yml` ä¸­è°ƒæ•´è§„åˆ™é˜ˆå€¼ï¼Œä½†å»ºè®®é€æ­¥ä¿®å¤è€Œä¸æ˜¯é™ä½æ ‡å‡†

### Q: ä¾èµ–å®‰å…¨æ‰«ææœ‰è¯¯æŠ¥ï¼Ÿ

A: åœ¨ `config/dependency-check-suppressions.xml` ä¸­æ·»åŠ æŠ‘åˆ¶è§„åˆ™

### Q: å¦‚ä½•è·³è¿‡æŸä¸ªæ£€æŸ¥ï¼Ÿ

A: ä¸å»ºè®®è·³è¿‡ï¼Œä½†ç´§æ€¥æƒ…å†µä¸‹å¯ä»¥æ·»åŠ  `-x` å‚æ•°ï¼š

```bash
./gradlew build -x detekt -x ktlintCheck
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Detekt å®˜æ–¹æ–‡æ¡£](https://detekt.dev/)
- [ktlint å®˜æ–¹æ–‡æ¡£](https://github.com/pinterest/ktlint)
- [OWASP ä¾èµ–æ£€æŸ¥](https://owasp.org/www-project-dependency-check/)
- [Pre-commit é…ç½®](https://pre-commit.com/)
- [Android ä»£ç è´¨é‡æŒ‡å—](https://developer.android.com/guide/code-quality)

---

**æç¤º**: ä»£ç è´¨é‡æ£€æŸ¥ä¸æ˜¯é™åˆ¶å¼€å‘çš„æ·é”ï¼Œè€Œæ˜¯æå‡ä»£ç è´¨é‡ã€å‡å°‘ bugã€æé«˜å¯ç»´æŠ¤æ€§çš„æœ‰æ•ˆå·¥å…·ã€‚å…»æˆè‰¯å¥½çš„ç¼–ç ä¹ æƒ¯ï¼Œè®©è´¨é‡æ£€æŸ¥æˆä¸ºå¼€å‘æµç¨‹çš„è‡ªç„¶ç»„æˆéƒ¨åˆ†ã€‚
